group_by(GENDER, MONTH_SLOT) %>%
filter(AGE_YRS >= 18) %>%
select(GENDER, HAS_BANK_AC,
MEM_WEIGHT_EXTN_ALL_HR_REGTYPE_STRATA_SAMPLE_WAVE,
NON_RESPONSE_FACTOR_MEM_EXTN_ALL_HR_REGTYPE_STRATA_WAVE) %>%
collect() %>%
mutate(wt = MEM_WEIGHT_EXTN_ALL_HR_REGTYPE_STRATA_SAMPLE_WAVE *
NON_RESPONSE_FACTOR_MEM_EXTN_ALL_HR_REGTYPE_STRATA_WAVE,
bankstatus = ifelse(HAS_BANK_AC == "Y", 1, 0)) %>%
summarize(banked_rate = weighted.mean(bankstatus, wt)) %>%
ungroup()
bankshare_ts <- bankshare_ts %>%
filter(complete.cases(GENDER) & (GENDER == "M" | GENDER == "F")) %>%
mutate(date = as.yearmon(MONTH_SLOT))
bankshare_ts %>%
ggplot() +
geom_line(aes(date, banked_rate, color = GENDER)) +
labs(title = "Banked Rate")
ds
ds %>% select(LITERACY) %?% collect() %>% summarize(unique(LITERACY))
ds %>% select(LITERACY) %>% collect() %>% summarize(unique(LITERACY))
"hi" %in% c("hi", "bye")
lit_ts <- ds %>%
group_by(GENDER, MONTH_SLOT) %>%
filter(AGE_YRS >= 18, LITERACY %in% c("Y", "N")) %>%
select(GENDER, LITERACY,
MEM_WEIGHT_EXTN_ALL_HR_REGTYPE_STRATA_SAMPLE_WAVE,
NON_RESPONSE_FACTOR_MEM_EXTN_ALL_HR_REGTYPE_STRATA_WAVE) %>%
collect() %>%
mutate(wt = MEM_WEIGHT_EXTN_ALL_HR_REGTYPE_STRATA_SAMPLE_WAVE *
NON_RESPONSE_FACTOR_MEM_EXTN_ALL_HR_REGTYPE_STRATA_WAVE,
literacy = case_when(
LITERACY == "Y" ~ 1,
LITERACY == "N" ~ 0
)) %>%
summarize(lit_rate = weighted.mean(literacy, wt)) %>%
ungroup()
lit_ts <- lit_ts %>%
mutate(date = as.yearmon(MONTH_SLOT))
lit_ts %>%
ggplot() +
geom_line(aes(date, lit_rate, color = GENDER))+
labs(title = "Literacy Rate")
library(tidyverse)
pwd(
)
getwd()
setwd("C:\Users\Hariharan\Documents\git_repos\SNIPar\ldsc_reg")
setwd("C:\\Users\\Hariharan\\Documents\\git_repos\\SNIPar\\ldsc_reg")
# reading in data
estimates <- read_csv("ukb_gs_estimates.csv")
estimates
# making confidence intervals
estimates <- estimates %>%
mutate(r_ci_lo = r - 1.96 * se_r,
r_ci_hi = r + 1.96 * se_r)
# plotting
estimates %>%
ggplot() +
geom_points(aes(Trait, r))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r))
estimates
# cleaning trait names
estimates <- estimates %>%
mutate(Trait = str_to_title(Trait))
estimates
estimates %>% View
# cleaning trait names
estimates <- estimates %>%
mutate(Trait = str_to_title(Trait),
Trait = str_replace_all(Trait, ".", " "))
estimates %>% View
library(tidyverse)
# reading in data
estimates <- read_csv("ukb_gs_estimates.csv")
# making confidence intervals
estimates <- estimates %>%
mutate(r_ci_lo = r - 1.96 * se_r,
r_ci_hi = r + 1.96 * se_r)
# cleaning trait names
estimates <- estimates %>%
mutate(Trait = str_to_title(Trait),
Trait = str_replace(Trait, ".", " "))
estimates
?str_replace
estimates %>% View
str_replace("hello.world", ".", " ")
str_replace("hello.world", "\.", " ")
str_replace("hello.world", "\\.", " ")
# reading in data
estimates <- read_csv("ukb_gs_estimates.csv")
# making confidence intervals
estimates <- estimates %>%
mutate(r_ci_lo = r - 1.96 * se_r,
r_ci_hi = r + 1.96 * se_r)
# cleaning trait names
estimates <- estimates %>%
mutate(Trait = str_to_title(Trait),
Trait = str_replace(Trait, "\\.", " "))
estimates
estimates %>% View
# cleaning trait names
estimates <- estimates %>%
mutate(Trait = str_to_title(Trait),
Trait = str_replace(Trait, "\\.", " "),
Trait = case_when(Trait == "Hdl" ~ "HDL",
Trait == "Aafb" ~ "AAFB",
Trait == "Fev1" ~ "FEV1",
Trait == "Ea" ~ "EA",
Trait == "Bmi" ~ "BMI",
TRUE))
?case_when
# cleaning trait names
estimates <- estimates %>%
mutate(Trait = str_to_title(Trait),
Trait = str_replace(Trait, "\\.", " "),
Trait = case_when(Trait == "Hdl" ~ "HDL",
Trait == "Aafb" ~ "AAFB",
Trait == "Fev1" ~ "FEV1",
Trait == "Ea" ~ "EA",
Trait == "Bmi" ~ "BMI",
TRUE ~ Trait))
estimates
estimates %>% View
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r, color = Trait))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r, color = Trait, type = Dataset))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 19)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 10)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 5)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, fill = Dataset),
size = 3)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd) +
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd) +
()
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd)
pd <- position_dodge(width=0.2,height=NULL)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd)
# plotting
pd <- position_dodge(width=0.2,height=NULL)
# plotting
pd <- position_dodge(width=0.2)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd)
# plotting
pd <- position_dodge(width=0.5)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd) +
geom_errorbar(aes(ymin = r_ci_lo, ymax = r_ci_hi),
width = 0.1, position = pd)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi),
width = 0.1, position = pd)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = pd)
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = pd) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.5))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(width=0.9)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge(width=0.9)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(width=0.9, preserve = "total")) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(width=0.9, preserve = "total")) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9, preserve = "total"))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(width=0.9, preserve = "single")) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9, preserve = "single"))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0,preserve = "single")) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9, preserve = "single"))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", WIDTH = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9, preserve = "single"))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.9, preserve = "single"))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0.5, preserve = "single"))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=2, preserve = "single"))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.1, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5))
estimates
levels = c("UKB", "Generation Scotland"))
estimates <- estimates %>%
mutate(Dataset = factor(Dataset,
levels = c("UKB", "Generation Scotland")))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5))
theme_set(theme_minimal())
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.5)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.6)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5))
ggsave("ukb_gs_estimates.png",
height = 6,
width = 9)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.6)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5)) +
labs(x = "Trait", y = "Genetic Correlation")
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.6)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5)) +
labs(x = "Trait", y = "Genetic Correlation")
ggsave("ukb_gs_estimates.png",
height = 6,
width = 10)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.6)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5)) +
labs(x = "Trait", y = "Genetic Correlation", color = "")
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.6)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5)) +
labs(x = "Trait", y = "Genetic Correlation") +
guides(color = FALSE)
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.6)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5)) +
labs(x = "Trait", y = "Genetic Correlation") +
guides(color = FALSE) +
theme(legend.position = c(0.3, 0.9))
# plotting
estimates %>%
ggplot() +
geom_point(aes(Trait, r,
color = Trait, shape = Dataset),
size = 3,
position = position_dodge2(padding = 0, preserve = "single", width = 0.6)) +
geom_errorbar(aes(x = Trait, ymin = r_ci_lo, ymax = r_ci_hi,
color = Trait),
width = 0.6, position = position_dodge2(width=0,
preserve = "single",
padding = 0.5)) +
labs(x = "Trait", y = "Genetic Correlation") +
guides(color = FALSE) +
theme(legend.position = c(0.3, 0.9))
ggsave("ukb_gs_estimates.png",
height = 6,
width = 13)
