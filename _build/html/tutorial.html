<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; snipar  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Guide" href="guide.html" />
    <link rel="prev" title="Welcome to snipar’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/snipar_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#test-data">Test data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inferring-ibd-between-siblings">Inferring IBD between siblings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#imputing-missing-parental-genotypes">Imputing missing parental genotypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#family-based-gwas">Family based GWAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#correlations-between-effects">Correlations between effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#polygenic-score-analyses">Polygenic score analyses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Documentation for snipar’s modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">snipar</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline"></a></h1>
<p>Tutorial on inferring IBD between siblings, imputing missing parental genotypes, and performing family based GWAS and polygenic score analyses. Before working through the tutorial, please first install the package and run the tests (see <a class="reference external" href="https://github.com/AlexTISYoung/SNIPar">github</a>).</p>
<section id="test-data">
<h2>Test data<a class="headerlink" href="#test-data" title="Permalink to this headline"></a></h2>
<p>To create a directory called ‘example_data/’ in the current directory and load the example data into it, use the command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">snipar_example_data.py</span> <span class="pre">--dest</span> <span class="pre">example_data</span></code></p>
</div></blockquote>
<p>You can create the example data directory elsewhere by changing the –dest argument.</p>
<p>In the example_data/ directory, there is some example data. The file phenotype.txt is a simulated phenotype with direct, paternal, and maternal effects, where 80% of the phenotypic
variance is explained by the combined direct, paternal and maternal effects of the SNPs; and the
pairwise correlations between the direct, paternal, and maternal effects are 0.5. Please change your working directory to example_data/:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">example_data</span></code></p>
</div></blockquote>
<p>The genotype data has been simulated so that there are 3000 independent families, where 1000 have two siblings but no parents genotyped,
1000 have one parent genotyped and a 50% chance of having a genotyped sibling, and the final 1000 have both parents genotyped and a 50%
chance of having a genotyped sibling. The example data includes genotype data formatted in both PLINK .bed format (chr_1.bed) and phased genotype
data in .bgen format (chr_1.bgen with associated sample file chr_1.sample).</p>
</section>
<section id="inferring-ibd-between-siblings">
<h2>Inferring IBD between siblings<a class="headerlink" href="#inferring-ibd-between-siblings" title="Permalink to this headline"></a></h2>
<p>The first step is to infer the identity-by-descent segments shared between siblings.
<em>snipar</em> contains a script, ibd.py, that employs a Hidden Markov Model (HMM) to infer the IBD segments for the sibling pairs.
The per-SNP genotyping error probability will be inferred from parent-offspring pairs when available;
alternatively, a genotyping error probability can be provided using the –p_error option. By default, SNPs with
genotyping error rates greater than 0.01 will be filtered out, but this threshold can be changed with the –max_error argument.
To infer the IBD segments from the genotype data in sample.bed,use the following command</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">ibd.py</span> <span class="pre">--bed</span> <span class="pre">chr_&#64;</span> <span class="pre">--king</span> <span class="pre">king.kin0</span> <span class="pre">--agesex</span> <span class="pre">agesex.txt</span> <span class="pre">--out</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span> <span class="pre">--ld_out</span></code></p>
</div></blockquote>
<p>This will output the IBD segments to a gzipped text file chr_1.ibd.segments.gz. Genotype files split over multiple chromosomes can be specified
using ‘&#64;’ as a numerical wildcard character. In this example, –bed chr_&#64; instructs ibd.py to search for plink bed files
chr_1.bed, chr_2.bed, …, chr_22.bed, where each bed file contains SNPs from the numbered chromosome. In this case, only one bed file
is in example_data/, chr_1.bed. If bed files for multiple chromosomes are found, IBD will be inferred separately for each chromosome, with one
output file per chromosome, with the chromosome number filling in the numerical wildcard in the –out argument. The <em>–king</em> argument requires the address of the relations (parent-offspring, sibling)
inferred by KING by using the –related –degree 1 command, and the <em>–agesex</em> argument requires the address of a white-space separated text file with columns ‘FID’ (family ID), ‘IID’
(individual ID), ‘age’, ‘sex’ (coded as ‘M’ for male and ‘F’ for female).</p>
<p>The algorithm requires a genetic map to compute the probabilities of transitioning between different IBD states.
If the genetic map positions (in cM) are provided in .bim file, the script will use these.
Alternatively, the <em>–map</em> argument allows the user to specify a genetic map in the same format as used by SHAPEIT
(<a class="reference external" href="https://mathgen.stats.ox.ac.uk/genetics_software/shapeit/shapeit.html#formats">https://mathgen.stats.ox.ac.uk/genetics_software/shapeit/shapeit.html#formats</a>) an example of which is
provided in genetic_map.txt.</p>
<p>If no genetic map is provided, then the deCODE sex-averaged map on Hg19 coordinates (Halldorsson, Bjarni V., et al. “Characterizing mutagenic effects of recombination through a sequence-level genetic map.” Science 363.6425 (2019).),
which is distributed as part of <em>snipar</em>, will be used.</p>
<p>The algorithm computes LD scores of SNPs in order to account for correlations between SNPs. The ‘–ld_out’ argument writes the LD scores to file in the same format as LDSC (<a class="reference external" href="https://github.com/bulik/ldsc">https://github.com/bulik/ldsc</a>).</p>
<p>The user can also input a phased .bgen file. For example, to infer IBD from chr_1.bgen using the genetic map in sample.genetic_map.txt, use this command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">ibd.py</span> <span class="pre">--bgen</span> <span class="pre">chr_&#64;</span> <span class="pre">--king</span> <span class="pre">king.kin0</span> <span class="pre">--agesex</span> <span class="pre">agesex.txt</span> <span class="pre">--out</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span> <span class="pre">--ld_out</span> <span class="pre">--map</span> <span class="pre">genetic_map.txt</span></code></p>
</div></blockquote>
<p>If the user has a pedigree file with columns FID (family ID), IID (individual ID), FATHER_ID (father ID), MOTHER_ID (mother ID), they can input that instead of the <em>–king</em> and <em>–agesex</em> arguments. Missing IDs in the pedigree are denoted by 0. Siblings are inferred as individuals in the pedigree that share both parents. (Warning: MZ twins should be removed from the pedigree to avoid confusing them with full-siblings.) Using the example pedigree in sample.ped, you can infer IBD using this command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">ibd.py</span> <span class="pre">--bed</span> <span class="pre">chr_&#64;</span> <span class="pre">--pedigree</span> <span class="pre">pedigree.txt</span> <span class="pre">--map</span> <span class="pre">genetic_map.txt</span> <span class="pre">--out</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span> <span class="pre">--ld_out</span></code></p>
</div></blockquote>
<p>The IBD inference can be performed on a smaller set of SNPs than will be imputed to save computation time.
For example, IBD inference could be performed using SNPs from a genotyping array, and the imputation performed using all SNPs that have been imputed from a reference panel. For imputation from siblings, SNPs that fall outside of regions covered by the IBD segments will be imputed as missing values.</p>
</section>
<section id="imputing-missing-parental-genotypes">
<h2>Imputing missing parental genotypes<a class="headerlink" href="#imputing-missing-parental-genotypes" title="Permalink to this headline"></a></h2>
<p>To impute the missing parental genotypes without using phase information, type:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">impute.py</span> <span class="pre">--ibd</span> <span class="pre">chr_&#64;.ibd</span> <span class="pre">--bed</span> <span class="pre">chr_&#64;</span> <span class="pre">--king</span> <span class="pre">king.kin0</span> <span class="pre">--agesex</span> <span class="pre">agesex.txt</span> <span class="pre">--out</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span></code></p>
</div></blockquote>
<p>The script constructs a pedigree from the output of KING’s relatedness inference (sample.king),
and age and sex information (sample.agesex). The pedigree along with the IBD segments shared between siblings recorded in chr_1.ibd.segments.gz are used to impute missing parental genotypes
from the observed sibling and parental genotypes in sample.bed. The imputed parental genotypes are in a HDF5 file sample.hdf5. The <em>–snipar_ibd</em> flag indicates the IBD segments are formatted as output by <em>snipar</em>.</p>
<p>If phased haplotypes are available in .bgen format, the imputation can use these as input, which improves the information gained by imputation
in certain situations. To perform imputation from the phased .bgen file in example_data/, use the following command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">impute.py</span> <span class="pre">--ibd</span> <span class="pre">chr_&#64;.ibd</span> <span class="pre">--bgen</span> <span class="pre">chr_&#64;</span> <span class="pre">--king</span> <span class="pre">king.kin0</span> <span class="pre">--agesex</span> <span class="pre">agesex.txt</span> <span class="pre">--out</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span></code></p>
</div></blockquote>
<p>It is necessary to provide the <em>–from_chr</em> and <em>–to_chr</em> arguments when imputing from a single .bgen file (not multiple .bgen files input with the numerical wildcard for chromosome number) since they often do not contain information on which chromosome
the SNPs are located on, and it’s necessary to match the IBD segments to the SNPs on the same chromosome.</p>
<p>To use IBD segments output by KING with the –ibdseg argument (sample.king.segments.gz), use the following command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">impute.py</span> <span class="pre">--ibd</span> <span class="pre">king</span> <span class="pre">--bgen</span> <span class="pre">chr_&#64;</span> <span class="pre">--king</span> <span class="pre">king.kin0</span> <span class="pre">--agesex</span> <span class="pre">agesex.txt</span> <span class="pre">--out</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span> <span class="pre">--ibd_is_king</span></code></p>
</div></blockquote>
<p>As with the ibd.py script, the impute_runner.py script can use a user input pedigree (with the <em>–pedigree</em> argument) rather than the <em>–king</em> and <em>–agesex</em> arguments.</p>
<p>Note that if memory issues are encountered running the imputation, the –chunks argument can be used to read the SNPs into memory in smaller batches (of number equal to the argument given to –chunks).</p>
</section>
<section id="family-based-gwas">
<h2>Family based GWAS<a class="headerlink" href="#family-based-gwas" title="Permalink to this headline"></a></h2>
<p>To compute summary statistics for direct, paternal, and maternal effects for all SNPs in the .bed file, type:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">gwas.py</span> <span class="pre">phenotype.txt</span> <span class="pre">--bed</span> <span class="pre">chr_&#64;</span> <span class="pre">--imp</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span></code></p>
</div></blockquote>
<p>This takes the observed genotypes in sample.bed and the imputed parental genotypes in sample.hdf5 and uses
them to perform, for each SNP, a joint regression onto the proband’s genotype, the father’s (imputed) genotype, and the mother’s
(imputed) genotype. This is done using a linear mixedl model that models phenotypic correlations between siblings,
where sibling relations in the pedigree are stored in the output of the imputation script: chr_1.hdf5. The ‘family variance estimate’ output is the  phenotypic variance explained by mean differences between sibships, and the residual variance is the remaining phenotypic variance.</p>
<p>To use the .bgen file instead, type:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">gwas.py</span> <span class="pre">phenotype.txt</span> <span class="pre">--bgen</span> <span class="pre">chr_&#64;</span> <span class="pre">--imp</span> <span class="pre">chr_&#64;</span> <span class="pre">--threads</span> <span class="pre">4</span></code></p>
</div></blockquote>
<p>The script outputs summary statistics in a gzipped text file: h2_quad_0.8.sumstats.gz. This file gives the chromosome,
SNP id, position, alleles (A1, the allele that effects are given with respect to; and A2, the alternative allele),
the frequency of the A1 allele, then summary statistics for each type of effect. For each effect, we give the
effective N for each SNP; this differs from the actual N due to the fact that there are differing amounts of information
for each type of effect, and due to relatedness in the sample. We give the effect estimate in the first column for each effect, the column
‘effect_Beta’, where ‘effect’ can be direct, paternal, etc; this is followed by the standard error, the Z-score,
and the negative log10 P-value for a non-zero effect. Even if not directly estimated in the regression,
we also output the average non-transmitted coefficient (NTC) estimate (estimate of the average of maternal NTC and paternal NTC),
and the population effect estimate, which is equivalent to what is estimated by standard GWAS methods that
regress phenotype onto genotype without control for parental genotypes. The final columns give the sampling
correlations between the different effect estimates at that SNP.</p>
<p>In addition to the plain text output, the effects and their sampling variance-covariance matrices are output in h2_quad_0.8.sumstats.hdf5.
The contents of the HDF5 file can be read into Python (using <a class="reference external" href="https://www.h5py.org">h5py</a>) and R (using <a class="reference external" href="https://www.bioconductor.org/packages/release/bioc/html/rhdf5.html">rhdf5</a>) easily.
The output contains different datasets:</p>
<ol class="arabic simple">
<li><p><em>estimate</em>, the estimated SNP effect, where each row gives a SNP, and each column gives an effect</p></li>
<li><p><em>bim</em>, equivalent to the bim file for plink, recording the information on each SNP</p></li>
<li><p><em>estimate_cols</em>, gives the names of the effects estimate for each SNP: direct, paternal, maternal, etc.</p></li>
<li><p><em>estimate_ses</em>, the standard errors for the effect estimates in <em>estimate</em></p></li>
<li><p><em>estimate_covariance</em>, 3 dimensional array with sampling variance-covariance matrices for each SNP’s estimated effects, with SNPs indexed by the first axis</p></li>
<li><p><em>freqs</em>, frequencies of the effect alleles</p></li>
<li><p><em>sigma2</em>, maximum likelihood estimate of the residual variance in the null model</p></li>
<li><p><em>tau</em>, maximum likelihood estimate of the ratio between the residual variance and family variance</p></li>
</ol>
<p>Now we have estimated SNP specific summary statistics. To compare to the true effects, run</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">estimate_sim_effects.py</span> <span class="pre">chr_1.sumstats.hdf5</span> <span class="pre">phenotype.effects.txt</span></code></p>
</div></blockquote>
<p>This should print estimates of the bias of the effect estimates.</p>
<p>The bias estimates for direct, paternal NTCs, maternal NTCs, and average NTCs should not be statistically significantly different from zero (with high probability). Population effects (which are estimated by univariate regression of individuals’ phenotypes onto their genotypes – as in standard GWAS)
here are biased estimates of direct effects, since population effects include both direct and indirect parental effects.</p>
<p>If the imputation has been performed from siblings alone, then the regression onto proband (focal, phenotyped individual), imputed paternal, and imputed maternal becomes
collinear. This is because the imputation is the same for paternal and maternal genotypes. In this case, the regression should be performed
onto proband and sum of imputed paternal and maternal genotypes. This can be achieved by providing the <em>–parsum</em> option to the script.
The script can also estimate indirect sibling effects for each SNP by providing the <em>–fit_sib</em> option; however, this
will reduce power for estimating other effects.</p>
<p>GWAS can also be performed without imputed parental genotypes. In this case, only probands with genotypes for both parents available will be used. In order to do this, one must provide a pedigree to gwas.py, as in:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">gwas.py</span> <span class="pre">phenotype.txt</span> <span class="pre">--out</span> <span class="pre">trios_</span> <span class="pre">--bgen</span> <span class="pre">chr_&#64;</span> <span class="pre">--pedigree</span> <span class="pre">pedigree.txt</span> <span class="pre">--threads</span> <span class="pre">4</span></code></p>
</div></blockquote>
</section>
<section id="correlations-between-effects">
<h2>Correlations between effects<a class="headerlink" href="#correlations-between-effects" title="Permalink to this headline"></a></h2>
<p><em>snipar</em> provides a script to compute correlations between direct and population effects and between direct effects and average NTCs.
To compute these correlations from the effects estimated in this tutorial (output by gwas.py to h2_quad_0.8.sumstats.gz)
using the LD scores computed by ibd.py (and output to 1.l2.ldscore.gz), use the following command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">correlate.py</span> <span class="pre">chr_&#64;</span> <span class="pre">effect</span> <span class="pre">--ldscores</span> <span class="pre">chr_&#64;</span></code></p>
</div></blockquote>
<p>This should give a correlation between direct effects and average NTCs of close to 0.5. The estimated correlations
and their standard errors, estimated by block-jacknife, are output to effect_corrs.txt.</p>
<p>The method is similar to LDSC, but correlates the marginal effects, adjusting for the known sampling variance-covariance matrix of the effects.
The LD scores are used for weighting. LD scores output by LDSC can be input. If LD scores are not available, they can be
computed from .bed files by providing them through the –bed argument.</p>
</section>
<section id="polygenic-score-analyses">
<h2>Polygenic score analyses<a class="headerlink" href="#polygenic-score-analyses" title="Permalink to this headline"></a></h2>
<p>In addition to family based GWAS, <em>snipar</em> provides a script (pgs.py) for computing polygenic scores (PGS) based on observed/imputed genotypes,
and for performing family based polygenic score analyses. Here, we give some examples of how to use this script. The script computes a PGS
from weights provided in <a class="reference external" href="https://github.com/bvilhjal/ldpred">LD-pred</a> format . The true direct genetic effects for the simulated trait are given as PGS weights in this format
in direct_weights.txt. This is a tab-delimited text file with a header and columns ‘chrom’ (chromosome), ‘pos’ (position), ‘sid’ (SNP ID), ‘nt1’ (allele 1),
‘nt2’ (allele 2), ‘raw_beta’ (raw effect estimates), ‘ldpred_beta’ (LD-pred adjusted weight). The script uses as weights the ‘ldpred_beta’ column.</p>
<p>To compute the PGS from the true direct effects, use the following command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">pgs.py</span> <span class="pre">direct</span> <span class="pre">--bed</span> <span class="pre">chr_&#64;</span> <span class="pre">--imp</span> <span class="pre">chr_&#64;</span> <span class="pre">--weights</span> <span class="pre">direct_weights.txt</span></code></p>
</div></blockquote>
<p>This uses the weights in the weights file to compute the polygenic scores for each genotyped individual for whom observed or imputed parental genotypes are available.
It outputs the PGS to direct.pgs.txt, which is a white-space delimited text file with columns FID (family ID, shared between siblings), IID (individual ID),
proband (PGS of individual with given IID), maternal (observed or imputed PGS of that individual’s mother), paternal (observed or imputed PGS of that individual’s father).
To use .bgen input, replace the <em>–bed</em> argument with <em>–bgen</em>.</p>
<p>To estimate direct, paternal, and maternal effects of the PGS, use the following command:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">pgs.py</span> <span class="pre">direct</span> <span class="pre">--pgs</span> <span class="pre">direct.pgs.txt</span> <span class="pre">--phenofile</span> <span class="pre">phenotype.txt</span></code></p>
</div></blockquote>
<p>This uses a linear mixed model that has a random effect for mean differences between families (defined as sibships here) and fixed effects for the direct,
paternal, and maternal effects of the PGS. It also estimates the ‘population’ effect of the PGS: the effect from regression of individuals’ phenotypes onto their PGS values.
The estimated effects and their standard errors are output to direct.effects.txt, with the effect names (direct, paternal, maternal, population) in the first column,
their estimates in the second column, and their standard errors in the final column. The sampling variance-covariance matrix of direct, paternal, and maternal effects is output in direct.vcov.txt.</p>
<p>Estimates of the direct effect of the PGS should be equal to 1 in expectation since
we are using the true direct effects as the weights, so the PGS corresponds to the true direct effect component of the trait.
The parental effect estimates capture the correlation between the direct and indirect parental effects. The population effect estimate
should be greater than 1, since this captures both the direct effect of the PGS, and the correlation between direct and indirect parental effects.</p>
<p>If parental genotypes have been imputed from sibling data alone, then imputed paternal and maternal PGS are perfectly correlated, and the above regression on proband, paternal, and maternal
PGS becomes co-linear. To deal with this, add the –parsum option to the above command, which will estimate the average parental effect rather than separate maternal and paternal effects of the PGS.</p>
<p>It is also possible to estimate indirect effects from siblings. We can compute the PGS for genotyped individuals with genotyped siblings and estimate direct, indirect sibling, paternal and maternal effects in
one command with the addition of the –fit_sib option:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">pgs.py</span> <span class="pre">direct_sib</span> <span class="pre">--bed</span> <span class="pre">chr_1</span> <span class="pre">--imp</span> <span class="pre">chr_1</span> <span class="pre">--weights</span> <span class="pre">direct_weights.txt</span> <span class="pre">--phenofile</span> <span class="pre">phenotype.txt</span> <span class="pre">--fit_sib</span></code></p>
</div></blockquote>
<p>This outputs the PGS values for each individual along with the PGS value of their sibling, and imputed/observed paternal and maternal PGS to direct_sib.pgs.txt.
(If an individual has multiple genotyped siblings, the average of the siblings’ PGS is used for the PGS of the sibling.)
It outputs estimates of direct, indirect sibling, paternal, and maternal effects of the PGS to direct_sib.effects.txt and their sampling variance-covariance matrix to direct_sib.vcov.txt.
Since indirect effects from siblings were zero in this simulation, the estimated sibling effect should be close to zero.</p>
<p>Note that the standard error for the direct effect estimate increases: this is due both to a drop in sample size since only those probands with genotyped siblings are included, and due to the fact that adding the sibling effect to the regression
decreases the independent information on the direct effect.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to snipar’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="guide.html" class="btn btn-neutral float-right" title="Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Alexander Young.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>